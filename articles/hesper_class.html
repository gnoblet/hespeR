<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>hesper_class • hespeR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="hesper_class">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hespeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/hesper_class.html">hesper_class</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>hesper_class</h1>
            
      

      <div class="d-none name"><code>hesper_class.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gnoblet.github.io/hespeR/">hespeR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview-of-hesper-s7-classes">Overview of hespeR S7 Classes<a class="anchor" aria-label="anchor" href="#overview-of-hesper-s7-classes"></a>
</h2>
<p>The <code>hespeR</code> package provides a set of <code>S7</code>
classes to structure and validate incoming survey data. Why so
restrictive? Restricting to these classes ensures that only valid
operations are performed, prevents accidental misuse, and allows for the
development of reusable and readable methods, towards semi-automated
reports. This design makes it easier to extend functionality through
methods if needed.</p>
<p>This said, helper functions are provided to convert from and to base
R objects (e.g., data frames, lists) that will be linked to a default
template of an XML Kobo tool.</p>
<div class="section level3">
<h3 id="main-classes">Main Classes<a class="anchor" aria-label="anchor" href="#main-classes"></a>
</h3>
<div class="section level4">
<h4 id="hespervector">
<code>HesperVector</code><a class="anchor" aria-label="anchor" href="#hespervector"></a>
</h4>
<p>Represents a single HESPER item. Main features to note are: -
<code>hesper_var</code>: the variable name of the HESPER item to which
this vector corresponds. - <code>hesper_vals</code>: the values for this
variable. It can contain <code>NA</code> values if
<code>allow_missing = TRUE</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HesperVector.html">HesperVector</a></span><span class="op">(</span></span>
<span>  hesper_var <span class="op">=</span> <span class="st">"hesper_food"</span>,</span>
<span>  hesper_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"no_serious_problem"</span>,</span>
<span>    <span class="st">"serious_problem"</span>,</span>
<span>    <span class="cn">NA</span>,</span>
<span>    <span class="st">"dnk"</span>,</span>
<span>    <span class="st">"pnta"</span>,</span>
<span>    <span class="st">"serious_problem"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  allow_missing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">hv</span></span>
<span><span class="co">#&gt; &lt;hespeR::HesperVector&gt;</span></span>
<span><span class="co">#&gt;  @ hesper_var   : chr "hesper_food"</span></span>
<span><span class="co">#&gt;  @ hesper_vals  : chr [1:6] "no_serious_problem" "serious_problem" NA "dnk" "pnta" ...</span></span>
<span><span class="co">#&gt;  @ allow_missing: logi TRUE</span></span>
<span><span class="co">#&gt;  @ hesper_bins  :List of 5</span></span>
<span><span class="co">#&gt;  .. $ serious_problem   : int [1:6] 0 1 NA 0 0 1</span></span>
<span><span class="co">#&gt;  .. $ no_serious_problem: int [1:6] 1 0 NA 0 0 0</span></span>
<span><span class="co">#&gt;  .. $ dnk               : int [1:6] 0 0 NA 1 0 0</span></span>
<span><span class="co">#&gt;  .. $ pnta              : int [1:6] 0 0 NA 0 1 0</span></span>
<span><span class="co">#&gt;  .. $ not_applicable    : int [1:6] 0 0 NA 0 0 0</span></span></code></pre></div>
<p>You’ve just seen printed that there is a <code>@hesper_bins</code>
property. A getter function adds <code>@hesper_bins</code> to the
object, which are the binary indicators (1/0) for each possible response
option. Binary variables will be useful for further analysis (faster,
simpler).</p>
<p>To access values for instance, you can simply run
<code>hv@hesper_vals</code> or
<code>S7::props(hv, "hesper_vals")</code>.</p>
<p>Note that <code>hesper_vals</code> and <code>hesper_var</code> can
only take a certain set of values, otherwise an error is thrown. This is
to ensure that only valid data is processed. Values are stored as
functions returning character vectors.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Variables/items</span></span>
<span><span class="fu"><a href="../reference/hesper_vars.html">hesper_vars</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "hesper_drinking_water"     "hesper_food"              </span></span>
<span><span class="co">#&gt;  [3] "hesper_shelter"            "hesper_toilet"            </span></span>
<span><span class="co">#&gt;  [5] "hesper_clean"              "hesper_clean_female"      </span></span>
<span><span class="co">#&gt;  [7] "hesper_clothes_etc"        "hesper_income_livelihood" </span></span>
<span><span class="co">#&gt;  [9] "hesper_health"             "hesper_health_care_male"  </span></span>
<span><span class="co">#&gt; [11] "hesper_health_care_female" "hesper_distress"          </span></span>
<span><span class="co">#&gt; [13] "hesper_safety"             "hesper_education"         </span></span>
<span><span class="co">#&gt; [15] "hesper_care"               "hesper_support"           </span></span>
<span><span class="co">#&gt; [17] "hesper_separation"         "hesper_displaced"         </span></span>
<span><span class="co">#&gt; [19] "hesper_information"        "hesper_aid"               </span></span>
<span><span class="co">#&gt; [21] "hesper_respect"            "hesper_movement"          </span></span>
<span><span class="co">#&gt; [23] "hesper_time"               "hesper_law"               </span></span>
<span><span class="co">#&gt; [25] "hesper_gbv"                "hesper_drug"              </span></span>
<span><span class="co">#&gt; [27] "hesper_mental_health"      "hesper_care_community"    </span></span>
<span><span class="co">#&gt; [29] "hesper_other"</span></span>
<span></span>
<span><span class="co"># Values/options</span></span>
<span><span class="fu"><a href="../reference/hesper_opts.html">hesper_opts</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "serious_problem"    "no_serious_problem" "dnk"               </span></span>
<span><span class="co">#&gt; [4] "pnta"               "not_applicable"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hesperlist">
<code>HesperList</code><a class="anchor" aria-label="anchor" href="#hesperlist"></a>
</h4>
<p>A list of <code>HesperVector</code> objects, representing a set of
variables for an individual or group. It inherits the validator for each
<code>HesperVector</code> and adds a few more checks (for instance it
checks that there are no duplicated HESPER item names nor different
lengths of vectors of values).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HesperVector.html">HesperVector</a></span><span class="op">(</span></span>
<span>  hesper_var <span class="op">=</span> <span class="st">"hesper_displaced"</span>,</span>
<span>  hesper_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"no_serious_problem"</span>,</span>
<span>    <span class="st">"serious_problem"</span>,</span>
<span>    <span class="st">"no_serious_problem"</span>,</span>
<span>    <span class="st">"dnk"</span>,</span>
<span>    <span class="st">"pnta"</span>,</span>
<span>    <span class="st">"serious_problem"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  allow_missing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">hl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HesperList.html">HesperList</a></span><span class="op">(</span>hesper_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">hv</span>, <span class="va">hv2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hl</span></span>
<span><span class="co">#&gt; &lt;hespeR::HesperList&gt;</span></span>
<span><span class="co">#&gt;  @ hesper_list:List of 2</span></span>
<span><span class="co">#&gt;  .. $ : &lt;hespeR::HesperVector&gt;</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_var   : chr "hesper_food"</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_vals  : chr [1:6] "no_serious_problem" "serious_problem" NA "dnk" ...</span></span>
<span><span class="co">#&gt;  ..  ..@ allow_missing: logi TRUE</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_bins  :List of 5</span></span>
<span><span class="co">#&gt;  .. .. .. $ serious_problem   : int [1:6] 0 1 NA 0 0 1</span></span>
<span><span class="co">#&gt;  .. .. .. $ no_serious_problem: int [1:6] 1 0 NA 0 0 0</span></span>
<span><span class="co">#&gt;  .. .. .. $ dnk               : int [1:6] 0 0 NA 1 0 0</span></span>
<span><span class="co">#&gt;  .. .. .. $ pnta              : int [1:6] 0 0 NA 0 1 0</span></span>
<span><span class="co">#&gt;  .. .. .. $ not_applicable    : int [1:6] 0 0 NA 0 0 0</span></span>
<span><span class="co">#&gt;  .. $ : &lt;hespeR::HesperVector&gt;</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_var   : chr "hesper_displaced"</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_vals  : chr [1:6] "no_serious_problem" "serious_problem" "no_serious_problem" "dnk" ...</span></span>
<span><span class="co">#&gt;  ..  ..@ allow_missing: logi TRUE</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_bins  :List of 5</span></span>
<span><span class="co">#&gt;  .. .. .. $ serious_problem   : int [1:6] 0 1 0 0 0 1</span></span>
<span><span class="co">#&gt;  .. .. .. $ no_serious_problem: int [1:6] 1 0 1 0 0 0</span></span>
<span><span class="co">#&gt;  .. .. .. $ dnk               : int [1:6] 0 0 0 1 0 0</span></span>
<span><span class="co">#&gt;  .. .. .. $ pnta              : int [1:6] 0 0 0 0 1 0</span></span>
<span><span class="co">#&gt;  .. .. .. $ not_applicable    : int [1:6] 0 0 0 0 0 0</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sl-skip-logic">
<code>SL</code> (Skip Logic)<a class="anchor" aria-label="anchor" href="#sl-skip-logic"></a>
</h4>
<p>Often, there would be other variables collected as part of a survey,
for instance demographic variables about the respondent or the
household. These variables can be used to define skip logic rules,
specifying when certain HESPER items should be set to missing based on
the values of these other variables.</p>
<p>A few examples are:</p>
<ul>
<li>If the person does not have children, then the 12th HESPER item
about education for the children should be set to missing; or,</li>
<li>for healthcare, there are different questions depending on the
gender of the respondent (e.g. access to maternal healthcare); or,</li>
<li>the 16th HESPER item about displacement from home should only be
asked to those who have suffered forced displacement.</li>
</ul>
<p>As such, there is a need for a class to define skip logic rules,
specifying when values should be set to missing based on other
variables.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sl_rule</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SL.html">SL</a></span><span class="op">(</span></span>
<span>  hesper_var <span class="op">=</span> <span class="st">"hesper_displaced"</span>,</span>
<span>  subset_var <span class="op">=</span> <span class="st">"pop_group"</span>,</span>
<span>  subset_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"host"</span>, <span class="st">"non_displaced"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sl_rule</span></span>
<span><span class="co">#&gt; &lt;hespeR::SL&gt;</span></span>
<span><span class="co">#&gt;  @ hesper_var : chr "hesper_displaced"</span></span>
<span><span class="co">#&gt;  @ subset_var : chr "pop_group"</span></span>
<span><span class="co">#&gt;  @ subset_vals: chr [1:2] "host" "non_displaced"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hesperlistenhanced">
<code>HesperListEnhanced</code><a class="anchor" aria-label="anchor" href="#hesperlistenhanced"></a>
</h4>
<p>Eventually, the last class <code>HesperListEnhanced</code> extends
<code>HesperList</code> by adding skip logic (<code>SL</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HesperListEnhanced.html">HesperListEnhanced</a></span><span class="op">(</span></span>
<span>  hesper_list <span class="op">=</span> <span class="va">hl</span><span class="op">@</span><span class="va">hesper_list</span>,</span>
<span>  other_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    pop_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"host"</span>, <span class="st">"refugee"</span>, <span class="st">"non_displaced"</span>, <span class="st">"host"</span>, <span class="st">"refugee"</span>, <span class="st">"host"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  SL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sl_rule</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>As such an very initial method to be used and added to the object is
<code><a href="../reference/apply_hesper_list_sl.html">apply_hesper_list_sl()</a></code>, which applies the skip logic rules
to the <code>HesperListEnhanced</code> object, setting values to
<code>NA</code> where appropriate and return the object
it-<code>self</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">hle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_hesper_list_sl.html">apply_hesper_list_sl</a></span><span class="op">(</span><span class="va">hle</span><span class="op">)</span></span>
<span><span class="va">hle</span></span>
<span><span class="co">#&gt; &lt;hespeR::HesperListEnhanced&gt;</span></span>
<span><span class="co">#&gt;  @ hesper_list:List of 2</span></span>
<span><span class="co">#&gt;  .. $ hesper_food     : &lt;hespeR::HesperVector&gt;</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_var   : chr "hesper_food"</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_vals  : chr [1:6] "no_serious_problem" "serious_problem" NA "dnk" ...</span></span>
<span><span class="co">#&gt;  ..  ..@ allow_missing: logi TRUE</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_bins  :List of 5</span></span>
<span><span class="co">#&gt;  .. .. .. $ serious_problem   : int [1:6] 0 1 NA 0 0 1</span></span>
<span><span class="co">#&gt;  .. .. .. $ no_serious_problem: int [1:6] 1 0 NA 0 0 0</span></span>
<span><span class="co">#&gt;  .. .. .. $ dnk               : int [1:6] 0 0 NA 1 0 0</span></span>
<span><span class="co">#&gt;  .. .. .. $ pnta              : int [1:6] 0 0 NA 0 1 0</span></span>
<span><span class="co">#&gt;  .. .. .. $ not_applicable    : int [1:6] 0 0 NA 0 0 0</span></span>
<span><span class="co">#&gt;  .. $ hesper_displaced: &lt;hespeR::HesperVector&gt;</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_var   : chr "hesper_displaced"</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_vals  : chr [1:6] NA "serious_problem" NA NA ...</span></span>
<span><span class="co">#&gt;  ..  ..@ allow_missing: logi TRUE</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_bins  :List of 5</span></span>
<span><span class="co">#&gt;  .. .. .. $ serious_problem   : int [1:6] NA 1 NA NA 0 NA</span></span>
<span><span class="co">#&gt;  .. .. .. $ no_serious_problem: int [1:6] NA 0 NA NA 0 NA</span></span>
<span><span class="co">#&gt;  .. .. .. $ dnk               : int [1:6] NA 0 NA NA 0 NA</span></span>
<span><span class="co">#&gt;  .. .. .. $ pnta              : int [1:6] NA 0 NA NA 1 NA</span></span>
<span><span class="co">#&gt;  .. .. .. $ not_applicable    : int [1:6] NA 0 NA NA 0 NA</span></span>
<span><span class="co">#&gt;  @ SL         :List of 1</span></span>
<span><span class="co">#&gt;  .. $ : &lt;hespeR::SL&gt;</span></span>
<span><span class="co">#&gt;  ..  ..@ hesper_var : chr "hesper_displaced"</span></span>
<span><span class="co">#&gt;  ..  ..@ subset_var : chr "pop_group"</span></span>
<span><span class="co">#&gt;  ..  ..@ subset_vals: chr [1:2] "host" "non_displaced"</span></span>
<span><span class="co">#&gt;  @ other_list :List of 1</span></span>
<span><span class="co">#&gt;  .. $ pop_group: chr [1:6] "host" "refugee" "non_displaced" "host" ...</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Guillaume Noblet, Raphael Bacot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
